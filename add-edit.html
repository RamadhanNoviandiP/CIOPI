<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base target="_top">
    <title>Improvement Form CI OPI</title>
    <!-- AdminLTE CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/css/adminlte.css">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        
 <style>
        .disabled-button {
            background-color: #e0e0e0 !important;
            color: #999999 !important;
            cursor: not-allowed !important;
        }

        .btn-modal {
          text-decoration: underline;
          color: blue;
          padding: 0;
          margin: 0 auto;
        }
        .button-up a {
            background-color: white; color: black; border-bottom: 4px solid #E1E1E1; padding: 0.5rem;
            text-decoration: none;
        }

        .button-up a:hover {
            border-bottom: 4px solid green;
        }
        .submit-form {
            border: #E1E1E1;
        }

        .submit-form input:focus {
            outline: none;
        }

    </style>
</head>

<body class="sidebar-mini layout-fixed">
  <!-- <?var url = getScriptUrl();?> -->
    <div class="wrapper">
        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
                </li>
                <!-- <li class="nav-item d-none d-sm-inline-block">
                <a href="#" class="nav-link">Home</a>
            </li> -->
            </ul>
        </nav>
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->

        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-light-primary elevation-4">
            <!-- Brand Logo -->
            <a href="<?=url?>" class="brand-link">
                <div class="brand-text font-weight-light" style="text-align: center">
                    <span class="font-weight-bold">SPIL</span>Organiser
                </div>
            </a>
            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar Menu -->
                <nav class="mt-4">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                        data-accordion="false">
                        <li class="nav-item">
                            <a href="#" class="nav-link">
                                <i class="nav-icon"><img src="https://www.spil.co.id/img/spil_logo.581f4306.svg" alt="logo-spil" style="width: 4vh;"></i>
                                <p class="font-weight-bold" style="font-size: 10pt; padding-left: 16px;">Connecting Islands</p>
                            </a>
                        </li>
                    </ul>
                    <div class="form-inline mt-4">
                        <div class="input-group mb-2" data-widget="sidebar-search">
                            <input class="form-control form-control-sidebar" type="search" placeholder="Search"
                                aria-label="Search">
                            <div class="input-group-append">
                                <button class="btn btn-sidebar">
                                    <i class="fas fa-search fa-fw"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="true">
                        <!-- Add more sidebar menu items here -->
                        <li class="nav-item border-bottom">
                            <a href="<?=url?>" class="nav-link" target="_top">
                                <h5>
                                    <b> My Activity </b>
                                </h5>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="<?=url?>" class="nav-link" target="_top">
                                <i class="nav-icon fa-circle-user fas"></i>
                                <p>
                                    CI/OPI
                                    <i class="right fas fa-angle-right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="#" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>
                                            Master
                                            <i class="right fas fa-angle-right"></i>
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        
                    </br>
                    
                    <!-- Add more sidebar menu items here -->
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Main content -->
            <section class="content" style="padding: 4vh;">
                <div class="container-fluid">
                    <!-- Your content goes here -->
                    <h3 style="font-weight: bold;">Improvement Plan</h3>
                    <h4 style="font-weight: lighter;">Unlocking Excellent!</h4>
                    
                </div>
                <div class="button-up"
                style="display: flex; justify-content: left; align-items: center; margin-left: 0.5rem; gap: 0.5rem;">
                    <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\ciopimyhistory.html">My History</a>
                    <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\needyourapproval-1.html">Need Approve</a>
                    <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\add-edit.html">Add / Edit</a>
                </div>
                <div class="submit-form">
                    <div class="project-title"
                    style="display: flex; padding: 0.6rem 1.3rem; background-color: #3D9970; margin: 1rem 0.5rem 0 0.5rem; border-radius: 15px; justify-content: center; align-items: center;">
                        <h3 style="color: white; font-size: 40px; font-weight: 600; width: 30%; text-align: center;">Project Title</h3>
                        <input type="text" placeholder="Input Project Title" style="width: 70%; height: 3rem;">
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Submisson Number</h4>
                        <input type="text" placeholder="Auto" style="width: 70%; text-align: center;">
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Name</h4>
                        <input type="text" placeholder="Auto" style="width: 70%; text-align: center;">
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Division / Departement</h4>
                        <input type="text" placeholder="Auto" style="width: 70%; text-align: center;">
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Location</h4>
                        <input type="text" placeholder="Auto" style="width: 70%; text-align: center;">
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Background</h4>
                        <input type="text" placeholder="Input Background Improvement" style="width: 70%; height: 8rem;">
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Improvement Benefit</h4>
                        <input type="text" placeholder="Input Improvement Benefit" style="width: 70%; height: 8rem;">
                    </div>
                    <div class="meassure-of-succes" style="padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Meassure Of Succes</h4>
                        <div class="box" style="box-shadow: 10px 10px 20px rgba(172, 172, 172, 0.25); padding: 1rem; background-color: white; border-radius: 10px;">
                            <table class="table table-striped">
                                <thead>
                                  <tr>
                                    <th scope="col" style="background-color: #3D9970; color: white;">No</th>
                                    <th scope="col" style="background-color: #3D9970; color: white;">Item</th>
                                    <th scope="col" style="background-color: #3D9970; color: white;">OUM</th>
                                    <th scope="col" style="background-color: #3D9970; color: white;">Baseline</th>
                                    <th scope="col" style="background-color: #3D9970; color: white;">Target</th>
                                    <th scope="col" style="background-color: #3D9970; color: white;">Description</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <th scope="row">1</th>
                                    <td>Peningkatan Mutu</td>
                                    <td>
                                        <div class="dropdown">
                                            <button class="btn btn-secondary dropdown-toggle btn-sm" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                              Select
                                            </button>
                                            <ul class="dropdown-menu">
                                              <li><a class="dropdown-item" href="#">Number</a></li>
                                              <li><a class="dropdown-item" href="#">Percentage</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td>
                                        <input type="number" placeholder="Baseline" style="outline: none; border: 2px solid #E1E1E1; border-radius: 5px;">
                                    </td>
                                    <td>
                                        <input type="number" placeholder="Target" style="outline: none; border: 2px solid #E1E1E1; border-radius: 5px;">
                                    </td>
                                    <td><input type="text" placeholder="Description" style="outline: none; border: 2px solid #E1E1E1; border-radius: 5px;"></td>
                                  </tr>
                                  <tr>
                                    <th scope="row">2</th>
                                    <td>Peningkatan Mutu</td>
                                    <td>
                                        <div class="dropdown">
                                            <button class="btn btn-secondary dropdown-toggle btn-sm" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                              Select
                                            </button>
                                            <ul class="dropdown-menu">
                                              <li><a class="dropdown-item" href="#">Number</a></li>
                                              <li><a class="dropdown-item" href="#">Percentage</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td>
                                        <input type="number" placeholder="Baseline" style="outline: none; border: 2px solid #E1E1E1; border-radius: 5px;">
                                    </td>
                                    <td>
                                        <input type="number" placeholder="Target" style="outline: none; border: 2px solid #E1E1E1; border-radius: 5px;">
                                    </td>
                                    <td><input type="text" placeholder="Description" style="outline: none; border: 2px solid #E1E1E1; border-radius: 5px;"></td>
                                  </tr>
                                </tbody>
                            </table>
                            <div style="margin-top: auto; display: flex; justify-content: flex-end; width: 100%;">
                                <button type="button" class="btn btn-success" style="font-size: 16px;">Add Meassure</button>
                            </div>
                        </div>
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Current Process</h4>
                        <input type="text" placeholder="Input Improvement Benefit" style="width: 70%; height: 8rem;">
                    </div>
                    <div class="submissiion-number" style="display: flex; padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Suggested Action</h4>
                        <input type="text" placeholder="Input Improvement Benefit" style="width: 70%; height: 8rem;">
                    </div>
                    <div class="member" style="padding: 1rem 1.3rem 0.5rem 1.3rem;">
                        <h4 style="font-weight: bold; font-size: 20px; width: 30%;">Team Members</h4>
                        <div class="box" style="box-shadow: 10px 10px 20px rgba(172, 172, 172, 0.25); padding: 1rem; background-color: white; border-radius: 10px;">
                            <table class="table table-striped" style="text-align: center;">
                                <thead>
                                  <tr>
                                    <th scope="col" style="background-color: #3D9970; color: white;">No</th>
                                    <th scope="col" style="background-color: #3D9970; color: white;">Team Members</th>
                                    <th scope="col" style="background-color: #3D9970; color: white;">Role</th>
                                </thead>
                                <tbody class="table-group-divider">
                                  <tr>
                                    <td>1</td>
                                    <td scope="row">Angger Widi Asmara</td>
                                    <td>Gamer</td>
                                  </tr>
                                  <tr>
                                    <td>2</td>
                                    <td scope="row">Angger Widi Asmara</td>
                                    <td>Gamer</td>
                                  </tr>
                                </tbody>
                              </table>
                            <div style="margin-top: auto; display: flex; justify-content: flex-end; width: 100%;">
                                <button type="button" class="btn btn-success">Add Member</button>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 2rem; display: flex; justify-content: flex-end; width: 100%;">
                        <button type="button" class="btn btn-success">Submit</button>
                    </div>
                </div>

                <!-- /.container-fluid -->
            </section>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->

        <!-- Main Footer -->
        <footer class="main-footer">
            <!-- To the right -->
            <div class="float-right d-none d-sm-inline">
                v1.0.0
            </div>
            <!-- Default to the left -->
            <strong>2024 SPIL. Crafted by HRIS & HRIS Army</strong>
        </footer>
    </div>
    <!-- ./wrapper -->

    <div class="modal fade" id="datamodal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            ...
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>

    <!-- REQUIRED SCRIPTS -->
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- AdminLTE -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/js/adminlte.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
   document.addEventListener('DOMContentLoaded', function() {
    google.script.run.withSuccessHandler(function(data2) {
        var data = JSON.parse(data2);
        data.sort((a, b) => {
          let dateA = new Date(a[1]);
          let dateB = new Date(b[1]);
          return dateB - dateA;
        });
        for (let i = 0; i < data.length; i++) {
          if(data[i][4] !== "- - - - - - -"){
            var row = document.createElement("tr");

            var cell = document.createElement("td");
            cell.textContent = i + 1;
            row.appendChild(cell);

            for (let j = 0; j < data[i].length; j++) {
                if(j != 6 && j < 6){
                  var cell = document.createElement("td");
                }
                if(j == 0){
                  var a = document.createElement("a");
                  console.log(data[i]);
                  // a.setAttribute ('href', data[i][6]);
                  // a.setAttribute ('target', '_blank');
                  a.textContent = data[i][j];
                  a.setAttribute('data-toggle', 'modal');
                  a.setAttribute('data-target', '#datamodalHO'+ i);
                  a.setAttribute('class', 'btn btn-xs btn-modal');
                  cell.appendChild(a);
                  var div = document.createElement("div");
                  div.innerHTML = `<div class="modal fade" id="datamodal`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel"> `+ data[i][0] +`</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        ...
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                      </div>
                    </div>
                  </div>
                </div>`
                cell.appendChild(div);
                }
                else if(j==6){

                }
                else if(j >= 6){

                }
                else{
                  cell.textContent = data[i][j];
                }
                row.appendChild(cell);
            }

              // Calculating Approved By
              const starting = 7;
              let approvedBy = "";
              for (let k = 0; k < 15; k++) {
                  console.log(data[i][starting + k]);
                  if (data[i] && data[i][starting + k] !== "#N/A" && data[i] && data[i][starting + k] !== "" ) {
                      approvedBy += "> <b>" + data[i][starting + k] + "</b><br/>";
                  }
              }
              if(data[i][5] === "Handover (Approved)") {
                approvedBy += "> <b> Atasan </b><br/>";
              }
              else if(data[i][5] === "Approved By HRBP") {
                approvedBy += "> <b> Atasan </b><br/>";
                approvedBy += "> <b> HRBP </b><br/>";
              }
              // Remove trailing comma and space from approvedBy string
              approvedBy = approvedBy.slice(0, -2);

                            // Calculating Approved By
              const starting1 = 22;
              let receiver = "";
              for (let k = 0; k < 15; k++) {
                  console.log(data[i][starting1 + k]);
                  if (data[i] && data[i][starting1 + k] !== "#N/A" && data[i] && data[i][starting1 + k] !== "" ) {
                      receiver += "> <b>" + data[i][starting1 + k] + "</b><br/>";
                  }
              }
              // Remove trailing comma and space from approvedBy string
              receiver = receiver.slice(0, -2);

            // Create Action buttons
            var actionCell = document.createElement("td");
            var handoverBtn = document.createElement("a");
            handoverBtn.className = "btn btn-info btn-xs";
            handoverBtn.textContent = "Handover";
            switch(data[i][5]){
              // case "Handover (Not Yet)":
              // var hoInput = document.createElement("input");
              // hoInput.setAttribute('type', 'hidden');
              // hoInput.value = data[i][0];
              
              //   handoverBtn.setAttribute('target', '_blank');
              //   handoverBtn.setAttribute('href', '<?=url?>?page=HandoverUI');
              //   break;
              case "Handover (Not Yet)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
                div.innerHTML = `<div class="modal fade" id="datamodalHO`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel"> Update </h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      No. Document : `+ data[i][0] +`
                      <br/>
                      Status : Not Yet
                      <br/>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>`
              actionCell.appendChild(div);
              break;
              case "Handover (Waiting For Aprroval)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
                div.innerHTML = `<div class="modal fade" id="datamodalHO`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel"> Update </h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      No. Document : `+ data[i][0] +`
                      <br/>
                      Status : Waiting For Approval
                      <br/>
                      Akan Disetujui Oleh: 
                      <br/>
                      ${receiver}
                      <br/>
                      Disetujui Oleh: 
                      <br/>
                      ${approvedBy}
                      <br/>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>`
              actionCell.appendChild(div);
              break;
              case "Approved By HRBP":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
              // Buat kode HTML untuk modal menggunakan template literal
              var modalHTML = `
              <div class="modal fade" id="datamodalHO${i}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Update</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body">
                              No. Dokumen: ${data[i][0]}
                              <br/>
                              Status: Approved By HRBP
                              <br/>
                              Disetujui Oleh: 
                              <br/>
                              ${approvedBy}
                              <br/>
                              Lihat Handover: <a href="${data[i][6]}" target="_blank">Lihat PDF</a>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                          </div>
                      </div>
                  </div>
              </div>`;

              // Set the innerHTML of the div to the modalHTML
              div.innerHTML = modalHTML;
              actionCell.appendChild(div);
              break;
              case "Handover (Approved)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
              // Buat kode HTML untuk modal menggunakan template literal
              var modalHTML = `
              <div class="modal fade" id="datamodalHO${i}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Update</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body">
                              No. Dokumen: ${data[i][0]}
                              <br/>
                              Status: Approved
                              <br/>
                              Disetujui Oleh: 
                              <br/>
                              ${approvedBy}
                              <br/>
                              Lihat Handover: <a href="${data[i][6]}" target="_blank">Lihat PDF</a>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                          </div>
                      </div>
                  </div>
              </div>`;

              // Set the innerHTML of the div to the modalHTML
              div.innerHTML = modalHTML;
              actionCell.appendChild(div);
              break;
              case "Handover (Waiting For Approval Atasan)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
              // Buat kode HTML untuk modal menggunakan template literal
              var modalHTML = `
              <div class="modal fade" id="datamodalHO${i}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Update</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body">
                              No. Dokumen: ${data[i][0]}
                              <br/>
                              Status: Waiting For Aprroval Atasan
                              <br/>
                              Disetujui Oleh: 
                              <br/>
                              ${approvedBy}
                              <br/>
                              Lihat Handover: <a href="${data[i][6]}" target="_blank">Lihat PDF</a>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                          </div>
                      </div>
                  </div>
              </div>`;

              // Set the innerHTML of the div to the modalHTML
              div.innerHTML = modalHTML;
              actionCell.appendChild(div);
              break;
            case "Handover (Rejected)":
              handoverBtn.setAttribute('target', '_blank'); 
              handoverBtn.setAttribute('data-toggle', 'modal');
              handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
              var div = document.createElement("div");
              div.innerHTML = `<div class="modal fade" id="datamodalHO`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"> Update </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    No. Document : `+ data[i][0] +`
                    <br/>
                    Status : Rejected
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>`
            actionCell.appendChild(div);
            break;
            }
            actionCell.appendChild(handoverBtn);
            row.appendChild(actionCell);

            document.getElementById("FAKTable").appendChild(row);
        }
      }
    }).withFailureHandler(handleError).getDataFromSheet();
});

function handleError(error) {
    console.error('Error : ' + error);
}

//refresh page
function reload() {
       google.script.run
      .withSuccessHandler(function(url){
        window.open(url,'_top');
      })
      .getScriptUrl();
}

function compareDates(item1, item2) {
    // Ubah string tanggal menjadi objek Date
    var dateObj1 = new Date(item1[1]);
    var dateObj2 = new Date(item2[1]);

    // Bandingkan tanggal
    if (dateObj1 < dateObj2) {
        return -1;
    } else if (dateObj1 > dateObj2) {
        return 1;
    } else {
        return 0;
    }
}

</script>

<!-- Add Meassure -->

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>

</html>
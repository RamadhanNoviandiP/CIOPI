<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base target="_top">
    <title>CI/OPI | History</title>
    <!-- AdminLTE CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/css/adminlte.css">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
 <style>
        .disabled-button {
            background-color: #e0e0e0 !important;
            color: #999999 !important;
            cursor: not-allowed !important;
        }

        .btn-modal {
          text-decoration: underline;
          color: blue;
          padding: 0;
          margin: 0 auto;
        }
    </style>
</head>

<body class="sidebar-mini layout-fixed">
  <?var url = getScriptUrl();?>
    <div class="wrapper">
        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
                </li>
                <!-- <li class="nav-item d-none d-sm-inline-block">
                <a href="#" class="nav-link">Home</a>
            </li> -->
            </ul>
        </nav>
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-light-primary elevation-4">
            <!-- Brand Logo -->
            <a href="<?=url?>" class="brand-link">
                <div class="brand-text font-weight-light" style="text-align: center">
                    <span class="font-weight-bold">SPIL</span>Organiser
                </div>
            </a>
            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar Menu -->
                <nav class="mt-4">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                        data-accordion="false">
                        <li class="nav-item">
                            <a href="#" class="nav-link">
                                <i class="nav-icon"><img src="https://www.spil.co.id/img/spil_logo.581f4306.svg" alt="logo-spil" style="width: 4vh;"></i>
                                <p class="font-weight-bold" style="font-size: 10pt; padding-left: 16px;">Connecting
                                    Islands</p>
                            </a>
                        </li>
                    </ul>
                    <div class="form-inline mt-4">
                        <div class="input-group mb-2" data-widget="sidebar-search">
                            <input class="form-control form-control-sidebar" type="search" placeholder="Search"
                                aria-label="Search">
                            <div class="input-group-append">
                                <button class="btn btn-sidebar">
                                    <i class="fas fa-search fa-fw"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="true">
                        <!-- Add more sidebar menu items here -->
                        <li class="nav-item border-bottom">
                            <a href="<?=url?>" class="nav-link" target="_top">
                                <h5>
                                    <b> My Activity </b>
                                </h5>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="<?=url?>" class="nav-link" target="_top">
                                <i class="nav-icon fa-circle-user fas"></i>
                                <p>
                                    CI/OPI
                                    <i class="right fas fa-angle-right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\ciopimyhistory.html" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>
                                            Master
                                            <i class="right fas fa-angle-right"></i>
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        
                    </br>
                        <!-- Add more sidebar menu items here -->
                        <li class="nav-item border-bottom">
                            <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\needyourapprovalA.html" class="nav-link" target="_top">
                                <h5>
                                    <b> Special Access </b>
                                </h5>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\needyourapprovalA.html" class="nav-link" target="_top">
                                <i class="nav-icon fa-circle-user fas"></i>
                                <p>
                                    Atasan A
                                    <i class="right fas fa-angle-right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\needyourapprovalA.html" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>
                                            Master
                                            <i class="right fas fa-angle-right"></i>
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="<?=url?>?page=DashboardAtasan" class="nav-link" target="_top">
                                <i class="nav-icon fa-circle-user fas"></i>
                                <p>
                                    Atasan B
                                    <i class="right fas fa-angle-right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="#" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>
                                            Master
                                            <i class="right fas fa-angle-right"></i>
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        
                        <li class="nav-item">
                            <a href="<?=url?>?page=DashboardAtasan" class="nav-link" target="_top">
                                <i class="nav-icon fa-circle-user fas"></i>
                                <p>
                                    PED
                                    <i class="right fas fa-angle-right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\ped.html" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>
                                            Master
                                            <i class="right fas fa-angle-right"></i>
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        </br>
                        </br>
                        <!-- Add more sidebar menu items here -->
                    </ul>
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Main content -->
            <section class="content" style="padding: 4vh;">
                <div class="container-fluid">
                    <!-- Your content goes here -->
                    <h3 class="font-weight-bold pb-3">CI/OPI</h3>
                    <div class="row">
                        
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-header">
                                    <div class="p3 row">
                                        <div class="col-sm-9" style="display: inline-flex; justify-content: space-between;">
                                            <div class="card-title">
                                                <i class="fas fa-filter mr-1"></i>
                                                <span class="font-weight-bold pl-2" style="font-size: 20px;">CI/OPI History</span>
                                            </div>
                                        </div>
                                        <div class="col-sm-1" style="float: right;">
                                          <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\ciopimyhistory.html" class="btn btn-primary btn-sm">My History</a>
                                        </div>
                                        <div class="col-sm-1" style="float: right;">
                                          <a href="C:\Users\ramad\OneDrive\Documents\CIOPI\CIOPI\needyourapprovalA.html" class="btn btn-secondary btn-sm">Need Approve</a>
                                        </div>
                                        <div class="col-sm-1" style="float: right;">
                                          <a href="<?=url?>?page=FAK" class="btn btn-secondary btn-sm">Add CI/OPI</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                  <div class="card-body">
                  <table id="tablePeriod" class="table table-bordered table-hover table-sm" style="width: 100%;">
                    <thead style="background-color: green; color: white;">
                      <tr>
                        <th>No</th>
                        <th>Doc. Number</th>
                        <th>Date Submited</th>
                        <th>Title </th>
                        <th>Last Status</th>
                        <th>Need Approval</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody id="CIOPITable">

                    </tbody>
                  </table>
                </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.container-fluid -->
            </section>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->

        <!-- Main Footer -->
        <footer class="main-footer">
            <!-- To the right -->
            <div class="float-right d-none d-sm-inline">
                v1.0.0
            </div>
            <!-- Default to the left -->
            <strong>2024 SPIL. Crafted by HRIS & HRIS Army</strong>
        </footer>
    </div>
    <!-- ./wrapper -->

    <div class="modal fade" id="datamodal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            ...
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>

    <!-- REQUIRED SCRIPTS -->
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- AdminLTE -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/js/adminlte.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
   document.addEventListener('DOMContentLoaded', function() {
    google.script.run.withSuccessHandler(function(data2) {
        var data = JSON.parse(data2);
        data.sort((a, b) => {
          let dateA = new Date(a[1]);
          let dateB = new Date(b[1]);
          return dateB - dateA;
        });
        for (let i = 0; i < data.length; i++) {
          if(data[i][4] !== "- - - - - - -"){
            var row = document.createElement("tr");

            var cell = document.createElement("td");
            cell.textContent = i + 1;
            row.appendChild(cell);

            for (let j = 0; j < data[i].length; j++) {
                if(j != 6 && j < 6){
                  var cell = document.createElement("td");
                }
                if(j == 0){
                  var a = document.createElement("a");
                  console.log(data[i]);
                  // a.setAttribute ('href', data[i][6]);
                  // a.setAttribute ('target', '_blank');
                  a.textContent = data[i][j];
                  a.setAttribute('data-toggle', 'modal');
                  a.setAttribute('data-target', '#datamodalHO'+ i);
                  a.setAttribute('class', 'btn btn-xs btn-modal');
                  cell.appendChild(a);
                  var div = document.createElement("div");
                  div.innerHTML = `<div class="modal fade" id="datamodal`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel"> `+ data[i][0] +`</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        ...
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                      </div>
                    </div>
                  </div>
                </div>`
                cell.appendChild(div);
                }
                else if(j==6){

                }
                else if(j >= 6){

                }
                else{
                  cell.textContent = data[i][j];
                }
                row.appendChild(cell);
            }

              // Calculating Approved By
              const starting = 7;
              let approvedBy = "";
              for (let k = 0; k < 15; k++) {
                  console.log(data[i][starting + k]);
                  if (data[i] && data[i][starting + k] !== "#N/A" && data[i] && data[i][starting + k] !== "" ) {
                      approvedBy += "> <b>" + data[i][starting + k] + "</b><br/>";
                  }
              }
              if(data[i][5] === "Handover (Approved)") {
                approvedBy += "> <b> Atasan </b><br/>";
              }
              else if(data[i][5] === "Approved By HRBP") {
                approvedBy += "> <b> Atasan </b><br/>";
                approvedBy += "> <b> HRBP </b><br/>";
              }
              // Remove trailing comma and space from approvedBy string
              approvedBy = approvedBy.slice(0, -2);

                            // Calculating Approved By
              const starting1 = 22;
              let receiver = "";
              for (let k = 0; k < 15; k++) {
                  console.log(data[i][starting1 + k]);
                  if (data[i] && data[i][starting1 + k] !== "#N/A" && data[i] && data[i][starting1 + k] !== "" ) {
                      receiver += "> <b>" + data[i][starting1 + k] + "</b><br/>";
                  }
              }
              // Remove trailing comma and space from approvedBy string
              receiver = receiver.slice(0, -2);

            // Create Action buttons
            var actionCell = document.createElement("td");
            var handoverBtn = document.createElement("a");
            handoverBtn.className = "btn btn-info btn-xs";
            handoverBtn.textContent = "Handover";
            switch(data[i][5]){
              // case "Handover (Not Yet)":
              // var hoInput = document.createElement("input");
              // hoInput.setAttribute('type', 'hidden');
              // hoInput.value = data[i][0];
              
              //   handoverBtn.setAttribute('target', '_blank');
              //   handoverBtn.setAttribute('href', '<?=url?>?page=HandoverUI');
              //   break;
              case "Handover (Not Yet)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
                div.innerHTML = `<div class="modal fade" id="datamodalHO`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel"> Update </h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      No. Document : `+ data[i][0] +`
                      <br/>
                      Status : Not Yet
                      <br/>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>`
              actionCell.appendChild(div);
              break;
              case "Handover (Waiting For Aprroval)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
                div.innerHTML = `<div class="modal fade" id="datamodalHO`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel"> Update </h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      No. Document : `+ data[i][0] +`
                      <br/>
                      Status : Waiting For Approval
                      <br/>
                      Akan Disetujui Oleh: 
                      <br/>
                      ${receiver}
                      <br/>
                      Disetujui Oleh: 
                      <br/>
                      ${approvedBy}
                      <br/>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>`
              actionCell.appendChild(div);
              break;
              case "Approved By HRBP":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
              // Buat kode HTML untuk modal menggunakan template literal
              var modalHTML = `
              <div class="modal fade" id="datamodalHO${i}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Update</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body">
                              No. Dokumen: ${data[i][0]}
                              <br/>
                              Status: Approved By HRBP
                              <br/>
                              Disetujui Oleh: 
                              <br/>
                              ${approvedBy}
                              <br/>
                              Lihat Handover: <a href="${data[i][6]}" target="_blank">Lihat PDF</a>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                          </div>
                      </div>
                  </div>
              </div>`;

              // Set the innerHTML of the div to the modalHTML
              div.innerHTML = modalHTML;
              actionCell.appendChild(div);
              break;
              case "Handover (Approved)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
              // Buat kode HTML untuk modal menggunakan template literal
              var modalHTML = `
              <div class="modal fade" id="datamodalHO${i}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Update</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body">
                              No. Dokumen: ${data[i][0]}
                              <br/>
                              Status: Approved
                              <br/>
                              Disetujui Oleh: 
                              <br/>
                              ${approvedBy}
                              <br/>
                              Lihat Handover: <a href="${data[i][6]}" target="_blank">Lihat PDF</a>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                          </div>
                      </div>
                  </div>
              </div>`;

              // Set the innerHTML of the div to the modalHTML
              div.innerHTML = modalHTML;
              actionCell.appendChild(div);
              break;
              case "Handover (Waiting For Approval Atasan)":
                handoverBtn.setAttribute('target', '_blank'); 
                handoverBtn.setAttribute('data-toggle', 'modal');
                handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
                var div = document.createElement("div");
              // Buat kode HTML untuk modal menggunakan template literal
              var modalHTML = `
              <div class="modal fade" id="datamodalHO${i}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Update</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body">
                              No. Dokumen: ${data[i][0]}
                              <br/>
                              Status: Waiting For Aprroval Atasan
                              <br/>
                              Disetujui Oleh: 
                              <br/>
                              ${approvedBy}
                              <br/>
                              Lihat Handover: <a href="${data[i][6]}" target="_blank">Lihat PDF</a>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                          </div>
                      </div>
                  </div>
              </div>`;

              // Set the innerHTML of the div to the modalHTML
              div.innerHTML = modalHTML;
              actionCell.appendChild(div);
              break;
            case "Handover (Rejected)":
              handoverBtn.setAttribute('target', '_blank'); 
              handoverBtn.setAttribute('data-toggle', 'modal');
              handoverBtn.setAttribute('data-target', '#datamodalHO'+ i);
              var div = document.createElement("div");
              div.innerHTML = `<div class="modal fade" id="datamodalHO`+ i +`" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"> Update </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    No. Document : `+ data[i][0] +`
                    <br/>
                    Status : Rejected
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>`
            actionCell.appendChild(div);
            break;
            }
            actionCell.appendChild(handoverBtn);

            // var rejectBtn = document.createElement("button");
            // rejectBtn.textContent = "Reject";
            // rejectBtn.className = "btn btn-danger btn-xs";

            // // Disable Rejected button
            // if (data[i][5] === 'Handover (Not Yet)' || data[i][5] === 'Handover (Waiting For Aprroval)' || data[i][5] === 'Handover (Waiting For Approval Atasan)' || data[i][5] === 'Handover (Rejected)' || data[i][5] === 'Handover (Completed)'|| data[i][5] === 'Rejected By HRBP' || data[i][5] === 'Approved By HRBP') {
            //     rejectBtn.className = "btn btn-secondary btn-xs"
            //     rejectBtn.disabled = true;
            //     //approveBtn.classList.add("disabled-button"); // Add custom CSS class
            // }

            // rejectBtn.addEventListener("click", function() {
            //     // Action when Reject button clicked
            //     google.script.run.setApprove(data[i][0], "No HRBP");
            //     reload();
            //   });
            // actionCell.appendChild(rejectBtn);

            // var approveBtn = document.createElement("button");
            // approveBtn.textContent = "Approve";
            // approveBtn.className = "btn btn-success btn-xs";

            // // Disable Approve button
            // if (data[i][5] === 'Handover (Not Yet)' || data[i][5] === 'Handover (Completed)' || data[i][5] === 'Handover (Waiting For Aprroval)' || data[i][5] === 'Handover (Waiting For Approval Atasan)' || data[i][5] === 'Rejected By HRBP' || data[i][5] === 'Approved By HRBP') {
            //     approveBtn.className = "btn btn-secondary btn-xs"
            //     approveBtn.disabled = true;
            //     //approveBtn.classList.add("disabled-button"); // Add custom CSS class
            // }

            // approveBtn.addEventListener("click", function() {
            //     // Action when Approve button clicked
            //     google.script.run.setApprove(data[i][0], "Yes HRBP");
            //     reload();
            // });

            // actionCell.appendChild(approveBtn);
            row.appendChild(actionCell);

            document.getElementById("CIOPITable").appendChild(row);
        }
      }
    }).withFailureHandler(handleError).getDataFromSheet();
});

function handleError(error) {
    console.error('Error : ' + error);
}

//refresh page
function reload() {
       google.script.run
      .withSuccessHandler(function(url){
        window.open(url,'_top');
      })
      .getScriptUrl();
}

function compareDates(item1, item2) {
    // Ubah string tanggal menjadi objek Date
    var dateObj1 = new Date(item1[1]);
    var dateObj2 = new Date(item2[1]);

    // Bandingkan tanggal
    if (dateObj1 < dateObj2) {
        return -1;
    } else if (dateObj1 > dateObj2) {
        return 1;
    } else {
        return 0;
    }
}

window.onload = function() {
    document.addEventListener("contextmenu", function(e) {
        e.preventDefault();
    }, false);

    document.addEventListener("keydown", function(e) {
        // "I" key
        if (e.ctrlKey && e.shiftKey && e.keyCode == 73) {
            disabledEvent(e);
        }
        // "J" key
        if (e.ctrlKey && e.shiftKey && e.keyCode == 74) {
            disabledEvent(e);
        }
        // "S" key + macOS
        if (e.keyCode == 83 && (navigator.platform.match("Mac") ? e.metaKey : e.ctrlKey)) {
            disabledEvent(e);
        }
        // "U" key
        if (e.ctrlKey && e.keyCode == 85) {
            disabledEvent(e);
        }
        // "F12" key
        if (e.keyCode == 123) {
            disabledEvent(e);
        }
        // "F1" key
        if (e.keyCode == 112) {
            disabledEvent(e);
        }
        // "F2" key
        if (e.keyCode == 113) {
            disabledEvent(e);
        }
        // "F3" key
        if (e.keyCode == 114) {
            disabledEvent(e);
        }
        // "F4" key
        if (e.keyCode == 115) {
            disabledEvent(e);
        }
        // "F5" key
        if (e.keyCode == 116) {
            disabledEvent(e);
        }
        // "F6" key
        if (e.keyCode == 117) {
            disabledEvent(e);
        }
        // "F7" key
        if (e.keyCode == 118) {
            disabledEvent(e);
        }
        // "F8" key
        if (e.keyCode == 119) {
            disabledEvent(e);
        }
        // "F9" key
        if (e.keyCode == 120) {
            disabledEvent(e);
        }
        // "F10" key
        if (e.keyCode == 121) {
            disabledEvent(e);
        }
        // "F11" key
        if (e.keyCode == 122) {
            disabledEvent(e);
        }
        // "Ctrl + Shift + C" key
        if (e.ctrlKey && e.shiftKey && e.keyCode == 67) {
            disabledEvent(e);
        }
    }, false);

    function disabledEvent(e) {
        if (e.stopPropagation) {
            e.stopPropagation();
        } else if (window.event) {
            window.event.cancelBubble = true;
        }
        e.preventDefault();
        return false;
    }

    // Panggil fungsi-fungsi lain di sini
    // generatePemberiOptions();
    // generatePenerimaOptions();
    // getEmailPemberi(); // Panggil fungsi untuk mendapatkan email pemberi
    // getEmailPenerima(); // Panggil fungsi untuk mendapatkan email penerima

    // // Generate ID Handover
    // generateIDHandover();
};

</script>
    
</body>

</html>